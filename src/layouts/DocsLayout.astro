---
import type { MarkdownHeading } from 'astro'
import type { TBreadcrump } from '../pages/[...slug].astro'

import { FooterBottom } from 'san-webkit-next/ui/app/Footer'
import { sluggify } from 'san-webkit-next/utils/url'

import Sidebar from '$components/Sidebar/Sidebar.astro'
import Breadcrumb from '$components/Breadcrumb/Breadcrumb.astro'
import ArticleFooter from '$components/ArticleFooter/index.svelte'
import ArticleHeadings from '$components/ArticleHeadings/index.svelte'
import H1 from '$components/markdown/headings/H1.astro'

type Props = {
  crumbs: TBreadcrump[]
  currentSlug: string
  title?: string
  headings: MarkdownHeading[]
}

const { crumbs = [], currentSlug, headings, title } = Astro.props
---

<div class="flex flex-col">
  <Sidebar transition:persist />

  <div class="flex w-full">
    <div class="md:none flex w-[286px] flex-grow md:flex-grow-0"></div>

    <div class="z-[1] flex w-[885px] flex-grow flex-col md:z-0">
      <main
        class="flex min-w-[86vh] flex-col px-10 pb-0 pt-[85px] md:px-0"
        data-pagefind-body
        transition:animate="fade"
      >
        <div class="wrapper">
          <Breadcrumb crumbs={crumbs} crumbLabel={currentSlug} />
          <ArticleHeadings headings={headings} />

          <div class="px-4">
            {title && <H1 id={sluggify(title)}>{title}</H1>}

            <slot />

            <ArticleFooter lastUpdatedAt={''} />
          </div>
        </div>
      </main>
      <div
        class="mt-14 [&>div]:py-7 [&>div]:pl-[55px] [&>div]:pr-[68px] [&_svg]:fill-rhino"
      >
        <FooterBottom />
      </div>
    </div>
  </div>
</div>
